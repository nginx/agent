# Codecov configuration file
# This file configures code coverage reporting and requirements for the project
coverage:

  # Coverage status configuration
  status:

    # Project-level coverage settings
    project:

      # Default status check configuration
      default:

        # The minimum required coverage value for the project
        target: 80%

        # The allowed coverage decrease before failing the status check
        threshold: 0%

        # Whether to run coverage checks only on pull requests
        only_pulls: false

    # Patch-level coverage settings
    patch:

      default:

        target: 80%
        threshold: 0%
        only_pulls: false

component_management:
    default_rules:
      statuses: []

    individual_components:
      - component_id: "internal/backoff"
        paths:
          - "internal/backoff/**"

      - component_id: "internal-bus"
        paths:
          - "internal/bus/**"

      - component_id: "internal/collector"
        paths:
          - "internal/collector/**"

      - component_id: "internal/command"
        paths:
          - "internal/command/**"

      - component_id: "internal/config"
        paths:
          - "internal/config/**"

      - component_id: "internal/datasource"
        paths:
          - "internal/datasource/**"

      - component_id: "internal/file"
        paths:
          - "internal/file/**"

      - component_id: "internal/grpc"
        paths:
          - "internal/grpc/**"

      - component_id: "internal/logger"
        paths:
          - "internal/logger/**"

      - component_id: "internal/model"
        paths:
          - "internal/model/**"

      - component_id: "internal/plugin"
        paths:
          - "internal/plugin/**"

      - component_id: "internal/resource"
        paths:
          - "internal/resource/**"

      - component_id: "internal/watcher"
        paths:
          - "internal/watcher/**"

      - component_id: "pkg/config"
        paths:
          - "pkg/config/**"

      - component_id: "pkg/files"
        paths:
          - "pkg/files/**"

      - component_id: "pkg/host"
        paths:
          - "pkg/host/**"

      - component_id: "pkg/id"
        paths:
          - "pkg/id/**"

      - component_id: "pkg/tls"
        paths:
          - "pkg/tls/**"

      - component_id: "cmd/agent"
        paths:
          - "cmd/agent/**"

      - component_id: "api"
        paths:
          - "api/**"

comment:
  layout: "header,diff,components,files,footer"
  behavior: default
  require_changes: false
  require_base: false
  require_head: true

# Ignore files or packages matching their paths
ignore:
  - '\.pb\.go$'       # Excludes all protobuf generated files
  - '\.gen\.go'      # Excludes generated files
  - '^fake_.*\.go'    # Excludes fakes
  - '^test/.*$'
  - 'app.go'          # app.go and main.go should be tested by integration tests.
  - 'main.go'
  # ignore metadata generated files
  - 'metadata/generated_.*\.go'
  # ignore wrappers around gopsutil
  - 'internal/datasource/host'
  - 'internal/watcher/process'
  - 'pkg/nginxprocess'
